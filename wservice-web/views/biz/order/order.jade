//
   Created by Leon on 15/10/15.

extends ../../layout/layout-bizpage
block titleContent
    title 订单管理
block content
    script(src="/js/biz/order/orderListGrid.js")
    script(src="/js/biz/order/orderProductsGrid.js")
    script(src="/js/biz/order/orderWorkorderGrid.js")
    script(src="/js/biz/order/orderForm.js")
    script(src="/js/biz/order/order.js")
    div(ng-app="orderApp")
        //内容区域
        div(ng-view)

        //列表模板
        script(type="text/ng-template",id="list.html")
            //功能导航区域
            ul.breadcrumb
                li
                    a(href="/app/home")
                        span.glyphicon.glyphicon-home
                        span 首页
                li.active 订单列表

            //功能导航
            nav.navbar.navbar-default.navbar-fixed-top
                div.container-fluid
                    div.navbar-header
                        a.navbar-brand(href="#") 订单列表
                    div.collapse.navbar-collapse
                        ul.nav.navbar-nav.navbar-right
                            li(ng-if="vm.orderList.loading()")
                                a(href="") 正在查询,请稍后...
                            li.dropdown(ng-if='!vm.orderList.loading()')
                                a.dropdown-toggle(href="",data-toggle="dropdown") 订单查询 - {{vm.queryName}}
                                    span.caret
                                ul.dropdown-menu
                                    li
                                        a(href="",ng-click="vm.queryByState('','全部')") 全部
                                    li
                                        a(href="",ng-click="vm.queryByState('waitconfirm','待确认')") 待确认
                                    li
                                        a(href="",ng-click="vm.queryByState('buy','待支付')") 待支付
                                    li
                                        a(href="",ng-click="vm.queryByState('inservice','服务中')") 服务中
                                    li
                                        a(href="") 条件查询

            div(npt-grid="vm.orderListGridOptions",model="vm.orderList.data")
            div(style="height:300px;")扩展内容
        //详情模板
        script(type="text/ng-template",id="detail.html")
            //功能导航区域
            ul.breadcrumb
                li
                    a(href="/home")
                        span.glyphicon.glyphicon-home
                        span 首页
                li
                    a(href="#list")
                        span 订单列表
                li.active 订单详情

            nav.navbar.navbar-default.navbar-fixed-top
                div.container-fluid
                    div.navbar-header
                        a.navbar-brand(href="") 订单详情
                    ul.nav.navbar-nav.navbar-right
                        li(ng-if="vm.orderInfo.loading()")
                            a(href="") 正在查询,请稍后...
                        li(ng-if="!vm.orderInfo.loading()")
                            a(href="",ng-click="vm.previous(vm.orderInfo.data.order)",ng-show="vm.orderList.previous(vm.orderInfo.data.order)") 上一单
                        li(ng-if="!vm.orderInfo.loading()")
                            a(href="",ng-click="vm.next(vm.orderInfo.data.order)",ng-show="vm.orderList.next(vm.orderInfo.data.order)") 下一单
                        li
                            a(href="#/confirm/{{vm.orderInfo.data.order.id}}",ng-show="vm.isConfirm()") 确认订单
                        li
                            a(href="",ng-click="vm.adviser()") 分配顾问
                        li
                            a(href="#/list") 返回

            //数据表格区域
            div.page-header
                h4 基本信息
            div.page-body
                div(npt-form="vm.orderFormOptions",model="vm.model.data.order")
            div.page-header
                h4 产品列表
            div.page-body
                div(npt-grid="vm.orderProductGridOptions",model="vm.modelProducts")
            div.page-header
                h4 工单列表
            div.page-body
                div(npt-grid="vm.orderWorkorderOptions",model="vm.modelWorkorders")

        //确认订单模板
        script(type="text/ng-template",id="confirm.html")
            ul.breadcrumb
                li
                    a(href="/home")
                        span.glyphicon.glyphicon-home
                        span 首页
                li
                    a(href="#list")
                        span 订单列表
                li
                    a(href="#detail/{{orderid}}")
                        span 订单详情
                li.active 确认订单

            nav.navbar.navbar-default
                div.navbar-header
                    a.navbar-brand(href="") 确认订单
                ul.nav.navbar-nav.navbar-right
                    li
                        a(href="#detail/{{orderid}}") 返回
                    li
                        | &nbsp &nbsp &nbsp &nbsp



