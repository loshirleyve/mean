/*! neptune  2015-11-16*/
angular.module("ui.neptune",["ui.neptune.tpls","ui.neptune.service","ui.neptune.validator","ui.neptune.filter","ui.neptune.directive","ui.neptune.formly"]),angular.module("ui.neptune.service",["ui.neptune.service.resource","ui.neptune.service.repository","ui.neptune.service.cache","ui.neptune.service.session","ui.neptune.service.datatableStore","ui.neptune.service.formStore"]),angular.module("ui.neptune.validator",["ui.neptune.validator.number2date","ui.neptune.validator.bizValidator"]),angular.module("ui.neptune.filter",["ui.neptune.filter.bizFilter"]),angular.module("ui.neptune.directive",["ui.neptune.directive.datatable","ui.neptune.directive.selectTree","ui.neptune.directive.form"]),angular.module("ui.neptune.service.cache",[]).provider("nptCache",function(){this.data={},this.$get=function(){function a(){}function b(){return new a}var c=this;return a.prototype.useByResponse=function(a){return a.cache&&angular.forEach(a.cache,function(a,b){var d=c.data[b]||{};c.data[b]=angular.extend(d,a)}),a},a.prototype.get=function(a,b){return a||b?a&&!b?c.data[a]:a&&b&&c.cache[a]?c.data[a][b]:void 0:c.data},b()}}).filter("cacheFilter",function(a){return function(b,c,d,e){if(!b||!c||!d)return b;var f=a.get(c);if(f&&e){var g;return angular.forEach(f,function(a){a[e]==b&&(g=a[d])}),g}return f?f[b][d]:b}}),angular.module("ui.neptune.service.datatableStore",[]).provider("nptDatatableStore",function(){this.datatables={},this.datatable=function(a,b){if(b||(b=a,a=b.name),!a)throw new Error("datatable must have a name.");return this.datatable.name=a,this.datatables[a]=b,this},this.$get=function(){var a=this,b={datatable:function(b,c){if(b&&c){if(!a.datatables[b])throw new Error("not found datatable "+b);c(a.datatables[b])}},putDatatable:function(b,c){a.datatable(b,c)}};return b}}),angular.module("ui.neptune.service.formStore",[]).provider("nptFormStore",function(){this.formConfigs={},this.form=function(a,b){if(b||(b=a,a=b.name),!a)throw new Error("formly must have a name.");return b.name=a,this.formConfigs[a]=b,this},this.$get=function(){var a=this,b={form:function(b,c){b&&c&&c(a.formConfigs[b])},put:function(b,c){return a.form(b,c),this}};return b}}),angular.module("ui.neptune.service.repository",[]).provider("nptRepository",function(){function a(a){return{originResponse:a,data:a.data.data,cache:a.data.cache,cause:a.data.cause,code:a.data.code,throwable:a.data.throwable}}this.baseURL="/service",this.actionKey="y9action",this._interceptors=[a],this.setBaseURL=function(a){a&&(this.baseURL=a)},this.setActionKey=function(a){a&&(this.actionKey=a)},this.$get=function(a,b,c){function d(){this._params={},this._lastParams=void 0,this._header={},this._baseURL=h.baseURL,this._action=void 0,this._responseInterceptors=[],this._requestInterceptors=[]}function e(d,e){var f={};f[h.actionKey]={name:e._action,params:d.params};var g=a.post(e._baseURL,f);return g=g.then(function(a){return"100"===a.data.code?a:b.reject(a.data.cause)},function(a){return b.reject(a)}),angular.forEach(h._interceptors,function(a){g=g.then(a)}),g=g.then(function(a){return a.request=d,a}),g=g.then(function(a){return c.useByResponse(a),a}),angular.forEach(e._responseInterceptors,function(a){g=g.then(a)}),g}function f(a,b,c){a&&(b||(angular.isArray(a)?angular.forEach(a,function(a){angular.extend(c,a)}):angular.extend(c,a)),a&&b&&angular.extend(c,{key:b}))}function g(a){var b=new d;return b.setAction(a),b}var h=this;return d.prototype.params=function(a,b){return f(a,b,this._params),this},d.prototype.header=function(a,b){return f(a,b,this._header),this},d.prototype.setAction=function(a){return this._action=a,this},d.prototype.addResponseInterceptor=function(a){return angular.isFunction(a)&&this._responseInterceptors.push(a),this},d.prototype.addRequestInterceptor=function(a){return angular.isFunction(a)&&this._requestInterceptors.push(a),this},d.prototype.post=function(a){var c={},d=this;angular.extend(c,h.params||{}),angular.extend(c,this._params||{}),angular.extend(c,a||{});var f={params:c||{}},g=b.defer(),i=g.promise;return g.resolve(f),this._requestInterceptors&&angular.forEach(this._requestInterceptors,function(a){i=i.then(a)}),i.then(function(a){return this._lastParams=a.params,a}).then(function(a){return e(a,d)})},d.prototype.refresh=function(){return this._lastParams?e(this._lastParams,this):void 0},g}}),angular.module("ui.neptune.service.resource",[]).provider("nptResource",function(){this.params={},this.header={},this.backendUrl="/service",this.cache={},this.originData={},this.setBackendUrl=function(a){this.backendUrl=a},this.$get=function(a){var b=this,c={post:function(c,d,e,f){d=d||{},angular.extend(d,b.params),a.post(b.backendUrl,{y9action:{name:c,params:d}}).success(function(a){if(b.originData=a,"100"===a.code){if(a.cache)for(var c in a.cache){var d=b.cache[c]||{};b.cache[c]=angular.extend(d,a.cache[c])}e&&e(a.data)}else f&&f(a)}).error(function(a){b.originData=a,f&&f(a)})},cache:function(a,c){return a||c?a&&!c?b.cache[a]:a&&c&&b.cache[a]?b.cache[a][c]:void 0:b.cache},originData:function(){return b.originData}};return c}}),angular.module("ui.neptune.service.session",[]).provider("nptSession",function(){this._baseURL="/session",this._userProp="user",this.setBaseURL=function(a){a&&(this._baseURL=a)},this.setUserProp=function(a){a&&(this._userProp=a)},this.$get=function(a){function b(){this._response=void 0,this._user=void 0}function c(){return a.get(d._baseURL).then(function(a){var c=new b;return c._response=a,c._user=a.data[d._userProp],c})}var d=this;return b.prototype.getUser=function(){return this._user},b.prototype.getResponse=function(){return this._response},c}}),angular.module("ui.neptune.validator.bizValidator",["ui.neptune.service.resource"]).directive("nptBizValidator",function(a,b,c,d,e){return{restrict:"A",require:"?ngModel",link:function(f,g,h,i){var j=h.nptBizValidatorOpts||{};i&&(i.$asyncValidators.bizvalidate=function(g,i){var k=h.ngModel,l={};k&&(l[k]=g),l.$value=g,l=angular.extend({},f,l),j=angular.isObject(j)?j:angular.fromJson(j);var m=d.getConfig(h.nptBizValidator)||{};j=e.extendConfig(m,j);var n=j.bizName,o=j.validator,p=j.bizParams,q=j.validExpression;if(q||(q={},q[h.ngModel]=h.ngModel),!n||!o)throw new Error("无效的nptBizValidator配置；"+(h.name||h.ngModel));var r=a.defer();return!n||!o||angular.isString(o)&&!c[o]||!angular.isString(o)&&!angular.isFunction(o)?(r.reject(new Error("无效的nptBizValidator配置；"+(h.name||h.ngModel))),r.promise):(p=e.parseParams(p,l),b.post(n,p,function(a){q=e.parseParams(q,l);var b=e.execute(o,a,q);b?r.resolve():r.reject()},function(a){r.reject(a)}),r.promise)},h.$observe("nptBizValidatorOpts",function(a){j=a?a:{},i.$validate()}))}}}).factory("nptBizValidatorHelper",function(a,b){return{extendConfig:function(a,b){return a.bizParams&&(a.bizParams=angular.extend(a.bizParams,b.bizParams||{}),delete b.bizParams),angular.extend(a,b)},parseParams:function(b,c){if(angular.isObject(b)){var d={};for(var e in b)d[e]=this.parseParams(b[e],c);return d}return angular.isDefined(b)?a(b)(c):void 0},execute:function(a,c,d){if(angular.isString(a))return b[a](c,d);if(angular.isFunction(a))return a(c,d);throw new Error("无法执行验证器："+a)}}}).service("nptBizValidatorService",function(a){this.exist=function(b,c){if(!b)return!1;if(!c)return angular.isArray(b)?b.length>0:!!b;var d=[];return d=angular.isString(c)?a("filter")(angular.isArray(b)?b:[b],c):a("filter")(angular.isArray(b)?b:[b],function(a,b,d){for(var e in c)if(c[e]!=a[e])return!1;return!0}),d&&d.length>0?!0:!1},this.noExist=function(a,b){return!this.exist(a,b)}}).provider("nptBizValidatorProvider",function(){var a={};this.addConfig=function(b,c){a[b]=c},this.$get=function(){return{getConfig:function(b){if(!b)return void 0;var c=a[b];return c?angular.copy(c):void 0}}}}).config(function(a){}),angular.module("ui.neptune.validator.number2date",[]).directive("nptNumber2date",function(){return{require:"ngModel",link:function(a,b,c,d){var e=function(a){var b=!1,c=a+"";if(a&&8===c.length){var e=c.substring(0,4)+"/"+c.substring(4,6)+"/"+c.substring(6,8),f=new Date(e);b=isNaN(f)?!1:!0}return d.$setValidity("nptNumber2date",b),a};d.$parsers.push(e),d.$formatters.push(e)}}}),angular.module("ui.neptune.filter.bizFilter",["ui.neptune.service.resource"]).directive("nptBizFilter",function(a,b,c){return{restrict:"A",require:"?ngModel",link:function(b,d,e,f){var g=e.nptBizFilter;if(!g)throw new Error("无效的指令器配置,"+e.ngModel);var h=g.split("|"),i=h[0]||e.ngModel,j=h[h.length-1].split(/\s+as\s+/),k=2==j.length?j[1]:e.ngModel;h[h.length-1]=2==j.length?j[0]:h[h.length-1],b.$watch(i,function(e,f){var g={};g.$value=e,g=angular.extend({},b,g),c.fire(a(h[0])(g),h.slice(1),g).then(function(c){if(k){var e=a(k).assign;e(b,c)}else c=angular.isObject(c)?angular.fromJson(c):c,$(d).html(c)},function(a){throw a})})}}}).service("nptBizFilterHelper",function(a,b,c,d,e){this.fire=function(b,c,d){var e=a.defer(),f=this,g=0,h=function(a){if(g==c.length)return void e.resolve(a);var b=c[g];f.filter(a,b,d).then(function(a){g++,h(a)},function(a){throw a})};return this.filter(b).then(function(a){h(a)}),e.promise},this.filter=function(c,e,f){var g=a.defer();if(!e)return g.resolve(c),g.promise;e=this.parseFilterExpression(e,f);var h=e.filterName,i=e.expression,j=d.getConfig(h);return j?this.doBizFilter(h,i,f):(g.resolve(b(h)(c,i)),g.promise)},this.doBizFilter=function(b,c,f){var g=a.defer();c=c||{},c=angular.isObject(c)?c:angular.fromJson(c);var h=d.getConfig(b);h.bizParams=h.bizParams||{},h.bizParams=this.linkContex(h.bizParams,f),angular.extend(h.bizParams,c);var i=this;return e.post(h.bizName,h.bizParams,function(a){h.chains?i.fire(a,h.chains,f).then(function(a){g.resolve(a)}):g.resolve(a)},function(a){g.reject(a)}),g.promise},this.linkContex=function(a,b){if(angular.isObject(a)){var d={};for(var e in a)d[e]=this.linkContex(a[e],b);return d}return this.quoteValueOfExpression(c(a)(b),b)},this.quoteValueOfExpression=function(a){if(!angular.isString(a))return a;var b={"!==":/!==\s*/,"===":/===\s*/,"==":/==\s*/,"<=":/<=\s*/,">=":/>=\s*/,"!=":/!=\s*/,"<":/<\s*/,">":/>\s*/,"=":/=\s*/};for(var c in b){var d=a.split(b[c]);if(2==d.length&&angular.isString(d[1])&&0!==d[1].indexOf('"')&&0!==d[1].indexOf("'"))return d[0]+c+'"'+d[1]+'"'}return a},this.parseFilterExpression=function(a,b){if(!a)return{};if(a.indexOf(":")>0){var c={};a=a.split(":");var d=a[0];return a=a.slice(1),a=a.join(":"),a=a.startsWith("{")?angular.fromJson(a):a,c.filterName=d,c.expression=this.linkContex(a,b),c}return{filterName:a}}}).filter("pickup",function(a){return function(b,c){var d=b;if(angular.isArray(b))d=b[0];else if(!angular.isObject(b))return d;return d=d||{},a(c)(d)}}).provider("nptBizFilterProvider",function(){var a={};this.addConfig=function(b,c){a[b]=c},this.$get=function(){return{getConfig:function(b){if(!b)return void 0;var c=a[b];return c?angular.copy(c):void 0}}}}).config(function(a){}),angular.module("ui.neptune.directive.datatable",["ui.bootstrap","formly","formlyBootstrap"]).constant("DatatableConfig",function(){return{currPage:1,maxSize:10,itemsPerPage:5,isIndex:!1,isPagination:!1}}).controller("datatableController",["$scope","$attrs","DatatableConfig","nptFormStore","$uibModal","$q","$injector",function(a,b,c,d,e,f,g){var h=this;a.controller&&(a.controller=this),this.$datatable={init:function(a,b){var d=this;if(this.header.init(a.header),this.action.init(a.action),d.page.init(c(),b),b.onAddListens)for(var e in b.onAddListens)this.putAddListen(b.onAddListens[e]);if(b.onDelListens)for(var f in b.onDelListens)this.putDelListen(b.onDelListens[f]);if(b.onEditListens)for(var g in b.onEditListens)this.putEditListen(b.onEditListens[g])},putAddListen:function(a){"function"==typeof a&&this.onAddListens.push(a)},putDelListen:function(a){"function"==typeof a&&this.onDelListens.push(a)},putEditListen:function(a){"function"==typeof a&&this.onEditListens.push(a)},onAddListens:[],onDelListens:[],onEditListens:[],handler:{add:function(b,c,d){var e=h.$forms.open(b.target,{});return e?e=e.then(function(c){var e={action:b,index:d,data:c},i=[];angular.forEach(h.$datatable.onAddListens,function(a){angular.isFunction(a)&&i.push(f.when(g.invoke(a,this,{params:e})))}),angular.forEach(b.listens,function(a){i.push(f.when(g.invoke(a,this,{params:e})))}),f.all(i).then(function(){a.data.push(e.data),console.info("添加执行成功.")},function(a){console.info("添加执行失败!"+JSON.stringify(a))})},function(a){console.info("添加操作取消")}):void 0},del:function(b,c,d){var e=f.defer(),i=e.promise,j={action:b,item:c,index:d};e.resolve(j),i.then(function(a){console.info("开始删除数据")},function(a){console.info("删除数据错误!"+a)});var k=[i];angular.forEach(h.$datatable.onDelListens,function(a){angular.isFunction(a)&&k.push(f.when(g.invoke(a,this,{params:j})))}),angular.forEach(b.listens,function(a){k.push(f.when(g.invoke(a,this,{params:j})))});var l=f.all(k).then(function(){a.data.splice(j.index,1)},function(a){console.info("删除失败!"+a)});return l},edit:function(a,b,c){var d=h.$forms.open(a.target,b);return d&&d.then(function(d){var e={action:a,index:c,data:d,item:angular.copy(b)},i=[];angular.forEach(h.$datatable.onEditListens,function(a){angular.isFunction(a)&&i.push(f.when(g.invoke(a,this,{params:e})))}),angular.forEach(a.listens,function(a){i.push(f.when(g.invoke(a,this,{params:e})))}),f.all(i).then(function(a){console.info("编辑操作成功!"),angular.extend(b,e.data)},function(a){console.info("编辑操作失败!")})},function(a){console.info("编辑操作取消")}),d},none:function(b,c,d){a.onAction&&a.onAction({action:b,item:c,index:d})}},header:{init:function(a){if(a)for(var b in a)this.items.push({name:b,label:a[b].label})},items:[]},action:{init:function(a){if(a)for(var b in a){var c={name:b,label:a[b].label,type:a[b].type||"none",target:a[b].target||void 0,listens:a[b].listens||[]};this.items.push(c)}},items:[],onClick:function(a,b,c){h.$datatable.handler[a.type]&&h.$datatable.handler[a.type](a,b,c)}},page:{init:function(a,b){this.currPage=b.currPage||a.currPage,this.totalItems=0,b.data&&(this.totalItems=b.data.length||0),this.maxSize=a.maxSize,this.itemsPerPage=b.itemsPerPage||a.itemsPerPage,this.isIndex=b.isIndex||a.isIndex,this.isPagination=b.isPagination||a.isPagination},data:[],pageChange:function(a){this.data=[];var b=0,c=0;if(this.isPagination?(b=this.currPage*this.itemsPerPage,c=this.currPage*this.itemsPerPage-this.itemsPerPage):(c=0,b=0,a&&(b=a.length)),a)for(c;b>c&&!(c>=a.length);c++)this.data.push(a[c])}}},a.datatable=this.$datatable,this.$forms={init:function(){},open:function(a,b){this.originData=b;var c={};angular.copy(b,c);var f=e.open({animation:!0,templateUrl:"/template/datatable/datatable-edit.html",controller:"editDatatableController",controllerAs:"vm",resolve:{formData:function(b){var e=b.defer();return d.form(a,function(a){e.resolve({fields:a.fields,model:c,options:a.options})}),e.promise}}}).result;return f},close:function(){e.close()}},a.forms=this.$forms}]).controller("editDatatableController",function(a,b){function c(){a.close(e.formData.model)}function d(){a.dismiss("cancel")}var e=this;e.ok=c,e.cancel=d,e.formData=b,e.originalFields=angular.copy(e.formData.fields)}).directive("nptDatatable",["$parse","nptDatatableStore",function(a,b){return{restrict:"E",controller:"datatableController",transclude:!0,replace:!0,templateUrl:function(a,b){return b.templateUrl||"/template/datatable/datatable.html"},scope:{name:"@",options:"=?",data:"=",isIndex:"=?",isPagination:"@",itemsPerPage:"=?",controller:"=",onAction:"&",onAddListens:"=",onEditListens:"=",onDelListens:"="},link:function(c,d,e,f){if(c.options?f.$datatable.init(c.options,c):b.datatable(c.name,function(a){f.$datatable.init(a,c)}),f.$forms.init(),c.$watchCollection("data",function(a,b){angular.isDefined(a)&&null!==a&&(f.$datatable.page.totalItems=a.length,f.$datatable.page.pageChange(c.data))}),c.$watch("datatable.page.currPage",function(a,b){f.$datatable.page.pageChange(c.data)}),e.name&&c.$parent){var g=a(e.name).assign;g(c.$parent,f)}}}}]),angular.module("ui.neptune.directive.form",[]).controller("FormControllect",["$scope",function(a){this.init=function(){},a.doAction=function(b){angular.isDefined(a.onClickAction)&&a.onClickAction({item:b})},a.doSave=function(){console.info("保存表单")},a.doReset=function(){console.info("重置表单")}}]).directive("nptForm",[function(){return{restrict:"E",controller:"FormControllect",replace:!0,templateUrl:function(a,b){return b.templateUrl||"/template/form/form.html"},scope:{model:"=?",data:"=",onClickAction:"&",onSave:"&",onReset:"&"},compile:function(a){return{pre:function(a,b,c,d){},post:function(a,b,c,d){}}}}}]),angular.module("ui.neptune.directive.selectTree",["ui.bootstrap","ui.tree","ui.grid","ui.grid.selection"]).controller("SelectTreeController",function(a,b){var c=this;this.selectTreeApi={open:function(){var a=this,c=b.open({animation:!0,templateUrl:"/template/select-tree/select-tree-modal.html",controller:"SelectTreeModalController",controllerAs:"vm",resolve:{selectTreeData:function(b){var c=b.defer();if(a.treeRepository&&a.listRepository){var d={treeRepository:a.treeRepository,listRepository:a.listRepository};c.resolve(d)}else c.reject();return c.promise}}}).result;return c}},a.nptSelectTree&&(a.nptSelectTree.treeRepository&&(c.selectTreeApi.treeRepository=a.nptSelectTree.treeRepository),a.nptSelectTree.listRepository&&(c.selectTreeApi.listRepository=a.nptSelectTree.listRepository),a.nptSelectTree.onRegisterApi&&a.nptSelectTree.onRegisterApi(this.selectTreeApi))}).controller("SelectTreeModalController",function(a,b,c){function d(){var b=a.gridApi.selection.getSelectedRows();c.close(b)}function e(){c.dismiss("cancel")}var f=this;f.ok=d,f.cancel=e,f.refreshTree=function(){b.treeRepository&&(f.refresh=b.treeRepository.post().then(function(a){f.treeData=a}))},f.refreshList=function(a){b.listRepository&&(f.refresh=b.listRepository.post(a).then(function(a){f.gridOptions.data=a.data}))},f.onTreeClick=function(a){f.refreshList(a)},f.gridOptions={enableRowSelection:!0,enableSelectAll:!1,enableFullRowSelection:!0,selectionRowHeaderWidth:35,rowHeight:35,showGridFooter:!0,multiSelect:!1,data:[],onRegisterApi:function(b){a.gridApi=b},columnDefs:[{name:"name",displayName:"名称"}]},f.refreshTree()}).directive("nptSelectTree",[function(){return{restrict:"A",transclude:!0,replace:!0,controller:"SelectTreeController",templateUrl:function(a,b){return b.templateUrl||"/template/select-tree/select-tree.html"},scope:{nptSelectTree:"="},link:function(a,b,c,d){}}}]),angular.module("ui.neptune.formly",["ui.neptune.formly.ui-select","ui.neptune.formly.ui-mask","ui.neptune.formly.ui-validation","ui.neptune.formly.wrapper-validation","ui.neptune.formly.select-tree-single"]),angular.module("ui.neptune.formly.ui-select",["ui.neptune.service.resource","ui.select","ngSanitize","ngAnimate","ngMessages","angular.filter"]),angular.module("ui.neptune.formly.ui-mask",["ui.utils.masks","ui.mask"]),angular.module("ui.neptune.formly.ui-validation",[]).constant("is",window.is),angular.module("ui.neptune.formly.ui-mask",["ui.utils.masks","ui.mask"]),angular.module("ui.neptune.formly.wrapper-validation",[]),angular.module("ui.neptune.formly.select-tree-single",[],function(a){a.setType({name:"npt-select-tree",templateUrl:"/template/formly/npt-select-tree-single.html","extends":"input",defaultOptions:{controller:function(a,b,c){var d=a.options,e=d.templateOptions;a.$watch("model."+d.key,function(b,f){if(b&&e.viewvalueRepository)if(angular.isFunction(e.viewvalueRepository))e.viewvalue=c.invoke(e.viewvalueRepository);else{var g={};g[e.viewvalueQueryProp]=b,e.viewvalueRepository.post(g).then(function(a){e.viewvalue=a.data[e.viewvalueProp]},function(b){a.model[d.key]=void 0})}})},templateOptions:{label:"请选择:",placeholder:"请选择.",valueProp:"id",labelProp:"name",viewvalueQueryProp:"id",viewvalueProp:"name",viewvalue:void 0,onClickSelect:function(a,b){var c=this;c.selectTreeApi.open().then(function(d){d&&d.length>0&&(a[b.key]=d[0][c.valueProp],c.viewvalue=d[0][c.labelProp])},function(){})},onRegisterApi:function(a){this.selectTreeApi=a},treeRepository:void 0,listRepository:void 0,viewvalueRepository:void 0}}})}),angular.module("ui.neptune.formly.ui-mask").run(function(a,b){a.setType({name:"maskedInput","extends":"input",defaultOptions:{ngModelAttrs:{mask:{attribute:"ui-mask"},maskPlaceholder:{attribute:"ui-mask-placeholder"},maskPlaceholderChar:{attribute:"ui-mask-placeholder-char"}},templateOptions:{maskPlaceholder:""}}}),a.setType({name:"numberInput","extends":"input",defaultOptions:{ngModelAttrs:{numberMask:{attribute:"ui-number-mask"},negativeNumber:{attribute:"ui-negative-number"},min:{attribute:"min"},max:{attribute:"max"}},templateOptions:{numberMask:"2",negativeNumber:""}}}),a.setType({name:"dateInput","extends":"input",defaultOptions:{ngModelAttrs:{mask:{attribute:"ui-mask"},maskPlaceholder:{attribute:"ui-mask-placeholder"},maskPlaceholderChar:{attribute:"ui-mask-placeholder-char"}},templateOptions:{maskPlaceholder:""},expressionProperties:{"templateOptions.mask":'to.formateType =="short"?"9999-99-99":"9999-99-99 99:99:99"'},parsers:[b.parseToDate],formatters:[b.formateToString]}})}).factory("uiMaskDateFactory",function(a){var b={};return b.parseToDate=function(a,b,c){if(!a)return a;var d=new Date(c.fc.$viewValue.replace(/-/,"/")).getTime();return d||void 0},b.formateToString=function(b,c,d){if(!c)return c;if(angular.isNumber(c)){var e=a("date"),f="short"==d.to.formateType?"yyyy-MM-dd":"yyyy-MM-dd hh:mm:ss",g=e(c,f);return g||void 0}},b}),angular.module("ui.neptune.formly.ui-select").run(function(a,b){a.setType({name:"ui-select","extends":"select",templateUrl:"/template/formly/ui-select.html",defaultOptions:{templateOptions:{ngOptions:"option[to.valueProp] as option in to.options | filterBy:[to.valueProp,to.labelProp]: $select.search",refresh:function(a,c,d){var e=b.when({data:[]});if(d.templateOptions.searchProp&&d.templateOptions.repository)if(a){var f=d.templateOptions.repositoryParams||{};f[d.templateOptions.searchProp]=a,e=d.templateOptions.repository.post(f)}else;else d.templateOptions.options&&d.templateOptions.options.length>0?e=b.when({data:d.templateOptions.options}):d.templateOptions.repository&&(e=d.templateOptions.repository.post(d.templateOptions.repositoryParams||{}));return e.then(function(a){d.templateOptions.options=angular.isArray(a.data)?a.data:[a.data]})},refreshDelay:0}}})}),angular.module("ui.neptune.formly.ui-validation").run(function(a,b,c,d){function e(c){var d={};d[c]={expression:b[c],message:'"Invalid '+c+'"'},a.setType({name:c,defaultOptions:{validators:d}})}e("boolean"),e("date"),e("nan"),e("null"),e("string"),e("char"),e("undefined"),e("empty"),e("existy"),e("truthy"),e("space"),e("url"),e("email"),e("creditCard"),e("timeString"),e("dateString"),e("hexColor"),e("ip"),a.setType({name:"ctrlCode",defaultOptions:{asyncValidators:{ctrlCode:{expression:function(a,b,e){var f=c.defer();return e.options.templateOptions.defNo?d.post({defno:e.options.templateOptions.defNo,no:a}).then(function(a){a.data&&0!==a.data.length?f.resolve():f.reject()},function(a){f.reject(a)}):f.reject(),f.promise},message:'"无效的控制编码"'}},modelOptions:{updateOn:"blur"}}})}).factory("QueryCtrlCode",function(a){return a("QueryMdCtrlcode")}),angular.module("ui.neptune.formly.wrapper-validation").config(function(a){a.setWrapper({name:"showErrorMessage",types:["input","select","textarea","radio","checkbox","multiCheckbox"],template:["<formly-transclude></formly-transclude>",'<div ng-messages="fc.$error" ng-if="form.$submitted || options.formControl.$touched" class="error-messages">','<div ng-message="{{ ::name }}" ng-repeat="(name, message) in ::options.validation.messages" class="message">{{ message(fc.$viewValue, fc.$modelValue, this)}}</div>',"</div>"].join("")})}),angular.module("ui.neptune.tpls",["/template/datatable/datatable-edit.html","/template/datatable/datatable.html","/template/form/form.html","/template/formly/npt-select-tree-single.html","/template/formly/ui-select.html","/template/select-tree/select-tree-modal.html","/template/select-tree/select-tree.html"]),angular.module("/template/datatable/datatable-edit.html",[]).run(["$templateCache",function(a){a.put("/template/datatable/datatable-edit.html",'<div><div class="modal-header"><button type="button" ng-click="vm.cancel()" aria-label="关闭" class="close"><span>&times</span></button><h4 class="modal-title">编辑</h4></div><div class="modal-body"><formly-form model="vm.formData.model" fields="vm.formData.fields" form="vm.form"></formly-form></div><div class="modal-footer"><button type="button" ng-click="vm.ok()" class="btn btn-primary">确定</button><button type="button" ng-click="vm.cancel()" class="btn btn-warning">取消</button></div></div>')}]),angular.module("/template/datatable/datatable.html",[]).run(["$templateCache",function(a){a.put("/template/datatable/datatable.html",'<div><div class="col-md-12"><!-- 设置为响应式表格 当页面宽度不够显示表格内容时会出现滚动条--><div class="table-responsive"><!-- table-striped表示隔行显示不同颜色条纹；table-hover鼠标悬停变色；table-bordered表格线框;table-condensed紧缩表格--><table class="table table-striped table-bordered table-hover table-condensed"><tfoot><tr ng-show="isPagination"><td colspan="50"><uib-pagination style="margin:0px;" total-items="datatable.page.totalItems" ng-model="datatable.page.currPage" items-per-page="datatable.page.itemsPerPage" max-size="datatable.page.maxSize" boundary-links="true" first-text="首页" previous-text="上一页" next-text="下一页" last-text="尾页" class="pagination-sm"></uib-pagination></td></tr></tfoot><thead><tr ng-show="isPagination"><td colspan="50"><uib-pagination style="margin:0px;" total-items="datatable.page.totalItems" ng-model="datatable.page.currPage" items-per-page="datatable.page.itemsPerPage" max-size="datatable.page.maxSize" boundary-links="true" first-text="首页" previous-text="上一页" next-text="下一页" last-text="尾页" class="pagination-sm"></uib-pagination></td></tr><tr><th ng-if="datatable.page.isIndex" class="text-center">&#24207;&#21495;</th><th ng-repeat="item in datatable.header.items" class="text-center">{{item.label}}</th><th ng-if="datatable.action.items.length&gt;0" class="text-center">&#25805;&#20316;</th></tr></thead><tbody><tr ng-repeat="item in datatable.page.data"><td ng-if="datatable.page.isIndex" class="text-center">{{($index+1)+(datatable.page.currPage * datatable.page.itemsPerPage - datatable.page.itemsPerPage)}}</td><td ng-repeat="headerItem in datatable.header.items">{{item[headerItem.name]}}</td><td ng-if="datatable.action.items.length&gt;0"><a ng-repeat="actionItem in datatable.action.items" href="" ng-click="datatable.action.onClick(actionItem,item,datatable.page.currPage * datatable.page.itemsPerPage - datatable.page.itemsPerPage + $parent.$index)" class="btn btn-primary btn-xs">{{actionItem.label}}</a></td></tr></tbody></table></div></div></div>')}]),angular.module("/template/form/form.html",[]).run(["$templateCache",function(a){a.put("/template/form/form.html","<div></div>")}]),angular.module("/template/formly/npt-select-tree-single.html",[]).run(["$templateCache",function(a){a.put("/template/formly/npt-select-tree-single.html",'<div><div npt-select-tree="to"></div><div class="input-group"><input placeholder="{{to.placeholder}}" type="text" ng-model="to.viewvalue" disabled class="form-control"><input type="text" ng-model="model[options.key]" disabled ng-hide="true" class="form-control"><span class="input-group-btn"><button type="button" ng-click="to.onClickSelect(model,options)" class="btn btn-primary">选择</button></span></div></div>')}]),angular.module("/template/formly/ui-select.html",[]).run(["$templateCache",function(a){a.put("/template/formly/ui-select.html",'<ui-select data-ng-model="model[options.key]" data-required="{{to.required}}" data-disabled="{{to.disabled}}" theme="bootstrap"><ui-select-match placeholder="{{to.placeholder}}" data-allow-clear="true">{{$select.selected[to.labelProp]}}</ui-select-match><ui-select-choices data-repeat="{{to.ngOptions}}" data-refresh="to.refresh($select.search,model, options)" data-refresh-delay="{{to.refreshDelay}}"><div ng-bind-html="option[to.labelProp] | highlight: $select.search"></div><small><span ng-bind-html="\'\'+option[to.smallLabelProp] | highlight: $select.search"></span></small></ui-select-choices></ui-select>')}]),angular.module("/template/select-tree/select-tree-modal.html",[]).run(["$templateCache",function(a){a.put("/template/select-tree/select-tree-modal.html",'<div><div class="modal-header"><button type="button" ng-click="vm.cancel()" aria-label="关闭" class="close"><span>&times</span></button><h4 class="modal-title">选择</h4></div><div class="modal-body"><div class="row"><div class="col-md-12"><p ng-show="vm.refresh.$$state.status === 0">正在加载数据,请稍后...</p><p ng-show="vm.refresh.$$state.status !== 0">&nbsp</p></div></div><div class="row"><div class="col-md-4"><div ui-tree id="tree-root" data-drag-enabled="false"><ol ui-tree-nodes ng-model="vm.treeData"><li ng-repeat="node in vm.treeData" ui-tree-node ng-include="\'org_nodes.html\'"></li></ol></div></div><div class="col-md-8"><div ui-grid="vm.gridOptions" ui-grid-selection class="grid"></div></div></div></div><div class="modal-footer"><button type="button" ng-click="vm.ok()" class="btn btn-primary">确定</button><button type="button" ng-click="vm.cancel()" class="btn btn-warning">取消</button></div><script type="text/ng-template" id="org_nodes.html"><div ui-tree-handle class="tree-node tree-node-content"><a ng-if="node.nodes &amp;&amp; node.nodes.length &gt; 0" ng-click="toggle(this)" class="btn btn-success btn-xs"><span ng-class="{\'glyphicon-chevron-right\': collapsed,\'glyphicon-chevron-down\': !collapsed}" class="glyphicon"></span></a>&nbsp &nbsp<a ng-click="vm.onTreeClick(node)" class="btn-link">{{node.title}}</a></div><ol ui-tree-nodes="" ng-model="node.nodes" ng-class="{hidden:collapsed}"><li ng-repeat="node in node.nodes" ui-tree-node ng-include="\'org_nodes.html\'"></li></ol></script></div>')}]),angular.module("/template/select-tree/select-tree.html",[]).run(["$templateCache",function(a){a.put("/template/select-tree/select-tree.html","<div></div>")}]);